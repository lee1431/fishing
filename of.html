<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#B57CFF" />
  
<title>STANCE â€” One-line Feed</title>

<style>
  :root{
    /* ===== theme ===== */
    --bg0:#070A10;
    --bg1:#0B1020;
    --ink:#EAF0FF;        /* ë©”ì¸ ê¸€ì (ë°ê²Œ) */
    --ink2:#C9D3EE;       /* ë³´ì¡° ê¸€ì */
    --muted:#9AA7C7;
    --line:rgba(255,255,255,.12);

    --glass:rgba(15,18,30,.46);    /* íŒ¨ë„ ë°”íƒ• */
    --glass2:rgba(255,255,255,.06);
    --shadow: 0 28px 90px rgba(0,0,0,.55);
    --shadow2: 0 10px 30px rgba(0,0,0,.35);

    --accent:#B57CFF;     /* í”Œë˜ë‹›ì¶©ì£¼ ë³´ë¼ ëŠë‚Œ */
    --accent2:#61D0FF;
    --ok:#7CFFA7;
    --warn:#FFC56B;
    --danger:#FF6B8F;

    --radius:18px;
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    color:var(--ink);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
    background:
      radial-gradient(1200px 700px at 20% 10%, rgba(181,124,255,.22), transparent 60%),
      radial-gradient(900px 600px at 80% 20%, rgba(97,208,255,.18), transparent 55%),
      radial-gradient(900px 600px at 60% 90%, rgba(124,255,167,.10), transparent 60%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
    overflow-x:hidden;
  }

  /* ===== subtle â€œtransparent displayâ€ noise & scanlines ===== */
  body::before{
    content:"";
    position:fixed; inset:0;
    background:
      repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.030) 0px,
        rgba(255,255,255,.030) 1px,
        rgba(0,0,0,0) 3px,
        rgba(0,0,0,0) 6px
      );
    mix-blend-mode: overlay;
    opacity:.25;
    pointer-events:none;
  }
  body::after{
    content:"";
    position:fixed; inset:-40px;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
    opacity:.12;
    pointer-events:none;
  }

  .wrap{
    width:min(980px, 92vw);
    margin:0 auto;
    padding:40px 0 64px;
  }

  /* ===== top brand ===== */
  .brand{
    display:flex;
    align-items:flex-start;
    gap:12px;
    margin-bottom:18px;
    user-select:none;
  }
  .logo{
    width:34px; height:34px;
    border-radius:12px;
    background:
      radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.55), transparent 55%),
      linear-gradient(135deg, rgba(181,124,255,.9), rgba(97,208,255,.7));
    box-shadow: 0 12px 28px rgba(181,124,255,.18);
  }
  .brand h1{
    margin:0;
    font-size:22px;
    letter-spacing:-.4px;
    line-height:1.1;
    text-shadow: 0 2px 18px rgba(0,0,0,.55);
  }
  .brand p{
    margin:6px 0 0;
    color:var(--muted);
    font-size:13px;
  }

  /* ===== glass panel ===== */
  .panel{
    position:relative;
    border-radius: var(--radius);
    background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)) , var(--glass);
    border:1px solid rgba(255,255,255,.12);
    box-shadow: var(--shadow);
    overflow:hidden;
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
  }

  .panel::before{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(900px 200px at 30% 0%, rgba(181,124,255,.20), transparent 60%),
      radial-gradient(800px 240px at 90% 10%, rgba(97,208,255,.14), transparent 62%),
      linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,0));
    opacity:.7;
    pointer-events:none;
  }

  /* ===== header bar ===== */
  .bar{
    position:relative;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:14px 16px;
    border-bottom:1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.10);
  }

  .pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:7px 10px;
    border-radius:999px;
    font-size:12px;
    color:var(--ink2);
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.10);
    box-shadow: var(--shadow2);
  }
  .dot{
    width:8px; height:8px;
    border-radius:50%;
    background: var(--ok);
    box-shadow: 0 0 0 6px rgba(124,255,167,.12), 0 0 18px rgba(124,255,167,.28);
  }

  .actions{
    display:flex;
    gap:10px;
  }
  .btn{
    appearance:none;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    color:var(--ink);
    padding:8px 12px;
    border-radius:12px;
    font-size:13px;
    cursor:pointer;
    transition: transform .08s ease, background .2s ease, border-color .2s ease;
    box-shadow: var(--shadow2);
  }
  .btn:hover{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.20); }
  .btn:active{ transform: translateY(1px) scale(.99); }
  .btn.primary{
    background: linear-gradient(135deg, rgba(181,124,255,.35), rgba(97,208,255,.22));
    border-color: rgba(181,124,255,.35);
  }

  /* ===== list ===== */
  .list{
    position:relative;
    padding:10px 10px 12px;
  }

  .item{
    display:grid;
    grid-template-columns: 42px 1fr auto;
    gap:12px;
    padding:12px 12px;
    border-radius:14px;
    margin:8px 4px;
    background: rgba(0,0,0,.18);
    border:1px solid rgba(255,255,255,.08);
    transition: background .2s ease, border-color .2s ease, transform .08s ease;
  }
  .item:hover{
    background: rgba(0,0,0,.26);
    border-color: rgba(255,255,255,.16);
  }
  .ico{
    width:38px; height:38px;
    border-radius:14px;
    display:grid; place-items:center;
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.10);
    font-size:18px;
    filter: drop-shadow(0 10px 18px rgba(0,0,0,.22));
  }

  .title{
    margin:0;
    font-size:15px;
    line-height:1.35;
    letter-spacing:-.2px;
    color: var(--ink);
    text-shadow: 0 1px 12px rgba(0,0,0,.38);
  }
  .meta{
    margin-top:6px;
    font-size:12px;
    color: var(--muted);
    display:flex;
    gap:10px;
    flex-wrap:wrap;
  }
  .tag{
    padding:4px 8px;
    border-radius:999px;
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.10);
    color: var(--ink2);
  }

  .time{
    font-size:12px;
    color: rgba(234,240,255,.80);
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    height: fit-content;
    align-self:center;
  }

  /* ===== footer hint ===== */
  .hint{
    padding:12px 16px 16px;
    color: rgba(234,240,255,.72);
    font-size:12px;
    border-top:1px solid rgba(255,255,255,.08);
    background: rgba(0,0,0,.10);
  }
  .hint b{ color: var(--ink); }
  .kbd{
    display:inline-block;
    padding:2px 7px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,.08);
    color: var(--ink);
    font-size:11px;
    margin:0 2px;
  }

  /* ===== small screen ===== */
  @media (max-width:560px){
    .item{ grid-template-columns: 42px 1fr; }
    .time{ grid-column: 2 / 3; justify-self:start; margin-top:8px; }
  }

  .box{border:1px solid rgba(255,255,255,.12);border-radius:14px;background:rgba(255,255,255,.06)}
  #log{height:55vh;overflow:auto;padding:14px}
  .row{display:flex;gap:10px;padding:14px;border-top:1px solid rgba(255,255,255,.10)}
  input{flex:1;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.25);color:#fff}
  button{padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.10);color:#fff;cursor:pointer}
  .sys{opacity:.75;font-size:.92rem}
  .msg{margin:8px 0}
  b{color:#a7f3d0}

/* ===== 2-column layout (feed left, chat right) ===== */
.grid2{
  display:grid;
  grid-template-columns: 1.35fr .9fr;
  gap:18px;
  align-items:start;
}

.chat-panel{
  padding:0;
}
.chat-panel .bar{
  border-bottom:1px solid rgba(255,255,255,.10);
}
.chat-panel .listlike{
  padding:10px;
}

/* ì±„íŒ…ì°½ ë†’ì´ & ìŠ¤í¬ë¡¤ */
#log{
  height: 52vh;          /* í•„ìš”í•˜ë©´ 45~65vhë¡œ ì¡°ì ˆ */
  overflow:auto;
  padding:14px;
}

/* ìš°ì¸¡ ì±„íŒ… ì…ë ¥ì¤„ì´ íŒ¨ë„ í•˜ë‹¨ì— ë”± ë¶™ê²Œ */
.chat-panel .row{
  border-top:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.10);
}

/* ëª¨ë°”ì¼ì—ì„œëŠ” ì•„ë˜ë¡œ ìŠ¤íƒ */
@media (max-width: 980px){
  .grid2{ grid-template-columns: 1fr; }
  #log{ height: 40vh; }
}


  /* ===== Chat layout refine ===== */
.chat-box{
  display:flex;
  flex-direction:column;
  height:100%;
}

/* ë‹‰ë„¤ì„ ì˜ì—­ */
.nick-row{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 14px;
  border-bottom:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.18);
}

.nick-row input{
  flex:1;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.25);
  color:#fff;
}

.nick-hint{
  font-size:11px;
  color:var(--muted);
  opacity:.8;
  white-space:nowrap;
}

/* ë¡œê·¸ ì˜ì—­ì´ ê°€ìš´ë°ì„œ ëŠ˜ì–´ë‚˜ë„ë¡ */
#log{
  flex:1;
  overflow:auto;
  padding:14px;
}

/* ë©”ì‹œì§€ ì…ë ¥ ì˜ì—­ */
.msg-row{
  display:flex;
  gap:10px;
  padding:12px 14px;
  border-top:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.20);
}

.msg-row input{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.25);
  color:#fff;
}

.msg-row button{
  padding:12px 16px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.10);
  color:#fff;
  cursor:pointer;
}

  .chatWrap{ width:min(980px,92vw); margin:18px auto 64px; }

.chatPanel{ width:min(360px,92vw); } /* ìš°ì¸¡ íŒ¨ë„ í­ */
.chatBody{ padding:12px; display:flex; flex-direction:column; gap:10px; }

.chatLog{
  height:52vh;
  overflow:auto;
  padding:12px;
  border-radius:14px;
  background: rgba(0,0,0,.16);
  border:1px solid rgba(255,255,255,.08);
}

.chatNameRow, .chatMsgRow{
  display:flex;
  gap:10px;
}

.chatInput{
  flex:1;
  padding:12px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.25);
  color:#fff;
  outline:none;
}

.chatHint{
  margin-top:-4px;
  font-size:12px;
  color: rgba(234,240,255,.62);
  padding-left:2px;
}

.msg{ margin:8px 0; }
.sys{ opacity:.72; font-size:.92rem; }
b{ color:#a7f3d0; }


  
  
</style>
</head>

<body>
  <div class="wrap">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>STANCE â€” One-line Feed</h1>
      </div>
    </div>

    <div class="grid2">

      <!-- LEFT: Feed -->
      <section class="panel" aria-label="One-line feed panel">
        <div class="bar">
          <div class="pill"><span class="dot"></span> LIVE PANEL</div>
          <div class="actions">
            <button class="btn primary" id="btnAdd">+ Add</button>
            <button class="btn" id="btnTop">Top</button>
          </div>
        </div>

        <div class="list" id="feed">
          <!-- (ê¸°ì¡´ feed itemë“¤ ê·¸ëŒ€ë¡œ) -->
          ...
        </div>

        <div class="hint">
          ë‹¨ì¶•í‚¤: <span class="kbd">A</span> ìƒˆ í•­ëª©(ë§¨ ìœ„), <span class="kbd">T</span> ë§¨ ìœ„ë¡œ
        </div>
      </section>

      <!-- RIGHT: Chat (feed íŒ¨ë„ì´ë‘ ê°™ì€ 'panel' ìŠ¤íƒ€ì¼ë¡œ í†µì¼) -->
      <div class="chatWrap">
  <section class="panel chatPanel" aria-label="Flask chat panel">
    <div class="bar">
      <div class="pill"><span class="dot"></span> Flask ì‹¤ì‹œê°„ ì±„íŒ…</div>
      <div class="actions">
        <button class="btn" id="btnFocusChat">Focus</button>
      </div>
    </div>

    <div class="chatBody">
      <div id="log" class="chatLog"></div>

      <!-- ë‹‰ë„¤ì„(ìœ„) -->
      <div class="chatNameRow">
        <input id="name" class="chatInput" placeholder="ë‹‰ë„¤ì„ (í•œ ë²ˆë§Œ ì„¤ì •)" />
        <button id="btnSetName" class="btn primary">Set</button>
      </div>
      <div class="chatHint" id="nameHint">â€» ë‹‰ë„¤ì„ì€ ìµœì´ˆ 1íšŒ ì„¤ì •</div>

      <!-- ë©”ì‹œì§€(ì•„ë˜) -->
      <div class="chatMsgRow">
        <input id="msg" class="chatInput" placeholder="ë©”ì‹œì§€ ì…ë ¥..." />
        <button id="send" class="btn">ì „ì†¡</button>
      </div>
    </div>
  </section>
</div>

    </div>
    <!-- âœ… 2ì—´ ë -->
  </div>


<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script>
  const feed = document.getElementById("feed");
  const btnAdd = document.getElementById("btnAdd");
  const btnTop = document.getElementById("btnTop");

  function pad(n){ return String(n).padStart(2,"0"); }

  function addItem(){
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = pad(now.getMonth()+1);
    const dd = pad(now.getDate());
    const hh = pad(now.getHours());
    const mi = pad(now.getMinutes());

    const el = document.createElement("article");
    el.className = "item";
    el.innerHTML = `
      <div class="ico">ğŸ“</div>
      <div>
        <p class="title" contenteditable="true" spellcheck="false">
          ì—¬ê¸°ì— í•œ ì¤„ ì…ë ¥í•˜ê³  Enter ì¹˜ì§€ ë§ê³  ê·¸ëƒ¥ ì €ì¥í•´ë¼ ã…‹ã…‹
        </p>
        <div class="meta">
          <span>${yyyy}-${mm}-${dd}</span>
          <span class="tag" contenteditable="true" spellcheck="false">ë©”ëª¨</span>
        </div>
      </div>
      <div class="time">${hh}:${mi}</div>
    `;

    feed.prepend(el);
    const title = el.querySelector(".title");
    title.focus();
    // ì»¤ì„œ ëìœ¼ë¡œ
    const range = document.createRange();
    range.selectNodeContents(title);
    range.collapse(false);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
  }

  btnAdd.addEventListener("click", addItem);
  btnTop.addEventListener("click", () => window.scrollTo({top:0, behavior:"smooth"}));

  window.addEventListener("keydown", (e) => {
    if(e.target && (e.target.isContentEditable || ["INPUT","TEXTAREA"].includes(e.target.tagName))) return;
    if(e.key.toLowerCase() === "a") addItem();
    if(e.key.toLowerCase() === "t") window.scrollTo({top:0, behavior:"smooth"});
  });


  

  const log = document.querySelector("#log");
  const nameEl = document.querySelector("#name");
  const msgEl  = document.querySelector("#msg");
  const sendBtn= document.querySelector("#send");
  const btnSet = document.querySelector("#btnSetName");
  const btnFocus = document.querySelector("#btnFocusChat");
  const nameHint = document.querySelector("#nameHint");

  const sock = io("https://mrdindoin.ddns.net", {
    path: "/jagannath/socket.io",
    transports: ["websocket"],
    withCredentials: true,
    reconnection: true,
    reconnectionAttempts: Infinity,
    reconnectionDelay: 600,
    reconnectionDelayMax: 3000
  });

  // ë‹‰ë„¤ì„ ìƒíƒœ
  let myName = localStorage.getItem("lf_chat_name") || "";
  let joinedOnce = false;

  if (myName) {
    nameEl.value = myName;
    nameEl.disabled = true;
    btnSet.disabled = true;
    nameHint.textContent = "â€» ë‹‰ë„¤ì„ ì„¤ì •ë¨";
  }

  function add(html){
    const div = document.createElement("div");
    div.className = "msg";
    div.innerHTML = html;
    log.appendChild(div);
    log.scrollTop = log.scrollHeight;
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, m => ({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
    }[m]));
  }

  function doJoinSilently(){
    if (!myName) return;
    // ì¬ì—°ê²° ë“±ìœ¼ë¡œ connectê°€ ë‹¤ì‹œ ë– ë„, í´ë¼ì—ì„œëŠ” 1íšŒë§Œ "ë‚´ UI ë¡œê·¸"ë¥¼ ì°ê³ 
    // ì„œë²„ì—ëŠ” sid ë°”ë€Œì—ˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ joinì€ ì¬ì „ì†¡ ê°€ëŠ¥
    sock.emit("join", { name: myName });
  }

  btnSet.addEventListener("click", () => {
    const v = (nameEl.value || "").trim().slice(0, 30);
    if (!v) {
      add(`<div class="sys">â€¢ ë‹‰ë„¤ì„ë¶€í„° ì…ë ¥í•´ì¤˜</div>`);
      nameEl.focus();
      return;
    }
    myName = v;
    localStorage.setItem("lf_chat_name", myName);

    nameEl.disabled = true;
    btnSet.disabled = true;
    nameHint.textContent = "â€» ë‹‰ë„¤ì„ ì„¤ì •ë¨";

    // ì—¬ê¸°ì„œ ë”± 1ë²ˆë§Œ join ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³ 
    if (!joinedOnce) {
      add(`<div class="sys">â€¢ ë‹‰ë„¤ì„ ì„¤ì •: ${escapeHtml(myName)}</div>`);
      joinedOnce = true;
    }

    doJoinSilently();
    msgEl.focus();
  });

  function send(){
    if (!myName) {
      add(`<div class="sys">â€¢ ë‹‰ë„¤ì„ì„ ë¨¼ì € Set í•´ì¤˜</div>`);
      nameEl.focus();
      return;
    }
    const msg = (msgEl.value || "").trim().slice(0, 500);
    if(!msg) return;
    sock.emit("chat", { name: myName, msg });
    msgEl.value = "";
    msgEl.focus();
  }

  sendBtn.addEventListener("click", send);
  msgEl.addEventListener("keydown", (e)=>{ if(e.key==="Enter") send(); });

  btnFocus?.addEventListener("click", ()=> msgEl.focus());

  // âœ… connect/disconnect ë¡œê·¸ëŠ” UIì— ì•ˆ ì°ìŒ(ì‹œë„ëŸ¬ì›€)
  sock.on("connect", () => {
    // ë‹‰ë„¤ì„ì´ ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ì¡°ìš©íˆ ì¬-joinë§Œ
    doJoinSilently();
  });

  // ì„œë²„ê°€ ë³´ë‚´ëŠ” system/join ë©”ì‹œì§€ê°€ ë„ˆë¬´ ë§ìœ¼ë©´, ì—¬ê¸°ì„œ í•„í„°ë§ ê°€ëŠ¥
  sock.on("system", (d) => {
    const m = (d.msg || "");
    // ì˜ˆ: "xxx joined"ëŠ” UIì—ì„œ ìˆ¨ê¸°ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
    // if (m.includes(" joined")) return;
    add(`<div class="sys">â€¢ ${escapeHtml(m)}</div>`);
  });

  sock.on("chat", (d) => {
    add(`<b>${escapeHtml(d.name || "anon")}</b> : ${escapeHtml(d.msg || "")}`);
  });





  
</script>
</body>
</html>
